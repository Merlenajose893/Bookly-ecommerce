<%- include('../../views/partials/header',{genres:genres}) -%>

  
    
  


    <!-- Navbar End -->
    <% if (message) { %>
        <div class="alert alert-danger" style="background-color: red; color: white; padding: 10px; text-align: center;">
            <h3><%= message %></h3>
        </div>
    <% } %>
   
    

    <!-- Featured Start -->
    <div class="container-fluid pt-5">
        <div class="row px-xl-5 pb-3">
            <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
                <div class="d-flex align-items-center border mb-4" style="padding: 30px;">
                    <h1 class="fa fa-check text-primary m-0 mr-3"></h1>
                    <h5 class="font-weight-semi-bold m-0">Wide Range Of Books</h5>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
                <div class="d-flex align-items-center border mb-4" style="padding: 30px;">
                    <h1 class="fa fa-shipping-fast text-primary m-0 mr-2"></h1>
                    <h5 class="font-weight-semi-bold m-0">Free Shipping</h5>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
                <div class="d-flex align-items-center border mb-4" style="padding: 30px;">
                    <h1 class="fas fa-exchange-alt text-primary m-0 mr-3"></h1>
                    <h5 class="font-weight-semi-bold m-0">Easy Refunds and Returns</h5>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
                <div class="d-flex align-items-center border mb-4" style="padding: 30px;">
                    <h1 class="fa fa-phone-volume text-primary m-0 mr-3"></h1>
                    <h5 class="font-weight-semi-bold m-0">24/7 Support</h5>
                </div>
            </div>
        </div>
    </div>
    <!-- Featured End -->


    <!-- Categories Start -->
    <!-- Categories Start -->
<!-- Categories Start -->



    
    <!-- Categories End -->


    <!-- Offer Start -->
   
    <!-- Offer End -->


    <!-- Books Start -->
    <div class="container-fluid pt-5">
        <div class="text-center mb-4">
            <h2 class="section-title px-5"><span class="px-2">Hot-Picks</span></h2>
        </div>
        <div class="row px-xl-5 pb-3">
            <% books.slice(0,4).forEach(function(book) { %>
                <div class="col-lg-3 col-md-4 col-sm-6 pb-1"> <!-- Reduced column sizes -->
                    <div class="card product-item border-0 mb-4" style="max-width: 280px; margin: 0 auto;"> <!-- Added max-width and center alignment -->
                        <!-- Product Image -->
                        <div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0">
                            <% if (book.images && book.images.length > 0) { %>
                                <img 
                                    class="img-fluid w-100" 
                                    src="/uploads/<%= book.images[0].split('/').pop() %>" 
                                    alt="<%= book.title %>"
                                    style="height: 200px; object-fit: contain;" 
                                >
                            <% } else { %>
                                <img 
                                    class="img-fluid w-100" 
                                    src="/path/to/placeholder.jpg" 
                                    alt="Placeholder Image"
                                    style="height: 200px; object-fit: contain;"
                                >
                            <% } %>
                        </div>
        
                        <!-- Product Details -->
                        <div class="card-body border-left border-right text-center p-0 pt-3 pb-2"> <!-- Reduced padding -->
                            <h6 class="text-truncate mb-2 px-3"> <!-- Added horizontal padding -->
                                <%= book.title %>
                            </h6>
                            <p class="mb-2 small"> <!-- Added 'small' class for author name -->
                                <%= book.author %>
                            </p>
                            
                            <!-- Price Section -->
                            <div class="d-flex justify-content-center align-items-center mb-2">
                                <h6 class="mr-2 mb-0">$<%= book.regularPrice %></h6>
                                <h6 class="text-muted mb-0">
                                    <del>$<%= book.salesPrice %></del>
                                </h6>
                            </div>
                        </div>
        
                        <!-- Action Buttons -->
                        <div class="card-footer d-flex justify-content-between bg-light border py-2"> <!-- Reduced padding -->
                            <a href="/book/<%= book._id %>" class="btn btn-sm text-dark p-0">
                                <i class="fas fa-eye text-primary mr-1"></i>
                                <span class="small">View Detail</span> <!-- Added 'small' class -->
                            </a>
                            <a href="#" class="btn btn-sm text-dark p-0">
                                <i class="fas fa-shopping-cart text-primary mr-1"></i>
                                <span class="small">Add To Cart</span> <!-- Added 'small' class -->
                            </a>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
    <!-- Books End -->


    <!-- Subscribe Start -->

    <!-- Subscribe End -->


    <!-- Books Start -->
  
    <div class="container-fluid pt-5">
        <div class="text-center mb-4">
            <h2 class="section-title px-5"><span class="px-2">New-Picks</span></h2>
        </div>
        <div class="row px-xl-5 pb-3">
            <% books.slice(5, 9).forEach(function(book) { %>
                <div class="col-lg-3 col-md-4 col-sm-6 pb-1"> <!-- Reduced column sizes -->
                    <div class="card product-item border-0 mb-4" style="max-width: 280px; margin: 0 auto;"> <!-- Added max-width and center alignment -->
                        <!-- Product Image -->
                        <div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0">
                            <% if (book.images && book.images.length > 0) { %>
                                <img 
                                    class="img-fluid w-100" 
                                    src="/uploads/<%= book.images[0].split('/').pop() %>" 
                                    alt="<%= book.title %>"
                                    style="height: 200px; object-fit: contain;"
                                >
                            <% } else { %>
                                <img 
                                    class="img-fluid w-100" 
                                    src="/path/to/placeholder.jpg" 
                                    alt="Placeholder Image"
                                    style="height: 200px; object-fit: contain;"
                                >
                            <% } %>
                        </div>
        
                        <!-- Product Details -->
                        <div class="card-body border-left border-right text-center p-0 pt-3 pb-2"> <!-- Reduced padding -->
                            <h6 class="text-truncate mb-2 px-3"> <!-- Added horizontal padding -->
                                <%= book.title %>
                            </h6>
                            <p class="mb-2 small"> <!-- Added 'small' class for author name -->
                                <%= book.author %>
                            </p>
                            
                            <!-- Price Section -->
                            <div class="d-flex justify-content-center align-items-center mb-2">
                                <h6 class="mr-2 mb-0">$<%= book.regularPrice %></h6>
                                <h6 class="text-muted mb-0">
                                    <del>$<%= book.salesPrice %></del>
                                </h6>
                            </div>
                        </div>
        
                        <!-- Action Buttons -->
                        <div class="card-footer d-flex justify-content-between bg-light border py-2"> <!-- Reduced padding -->
                            <a href="/book/<%= book._id %>" class="btn btn-sm text-dark p-0">
                                <i class="fas fa-eye text-primary mr-1"></i>
                                <span class="small">View Detail</span> <!-- Added 'small' class -->
                            </a>
                            <a href="#" class="btn btn-sm text-dark p-0">
                                <i class="fas fa-shopping-cart text-primary mr-1"></i>
                                <span class="small">Add To Cart</span> <!-- Added 'small' class -->
                            </a>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
    <!-- Books End -->


    <!-- Vendor Start -->
    <div class="container-fluid py-5">
        <div class="row px-xl-5">
            <div class="col">
                <div class="owl-carousel vendor-carousel">
                    <div class="vendor-item border p-4">
                        <img src="img/logo-1.png" alt="">
                    </div>
                    <div class="vendor-item border p-4">
                        <img src="img/P2 1.png" alt="">
                    </div>
                    <div class="vendor-item border p-4">
                        <img src="img/logo-2.jpg" alt="">
                    </div>
                    <div class="vendor-item border p-4">
                        <img src="img/logo-3.png" alt="">
                    </div>
                    <div class="vendor-item border p-4">
                        <img src="img/P3 1.png" alt="">
                    </div>
                    <div class="vendor-item border p-4">
                        <img src="img/logo-4.png" alt="">
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Vendor End -->


    <!-- Footer Start -->
   <%-include('../../views/partials/footer.js')%>
    <!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
    <script>
        function toggleDropdown(event) {
    event.preventDefault(); // Prevent default link behavior
    const dropdown = event.target.closest('.dropdown'); // Find the closest dropdown container
    const menu = dropdown.querySelector('.dropdown-menu'); // Find the dropdown menu
  
    if (menu.classList.contains('show')) {
      menu.classList.remove('show'); // Close the dropdown if it's open
    } else {
      menu.classList.add('show'); // Open the dropdown
    }
  }
  
      </script>
      <script>
        document.getElementById("searchForm").addEventListener("submit", async function (event) {
            event.preventDefault(); // Prevent page refresh
            const query = document.getElementById("searchInput").value.trim(); // Get search text
    
            if (query) {
                try {
                    const response = await fetch(`/search?query=${searchQuery}`); // Send search request
                    const data = await response.json();
    
                    if (data.bookId) {
                        window.location.href = `/book/${data.id}`; // Redirect to book details page
                    } else {
                        alert("Book not found!"); // Show alert if book not found
                    }
                } catch (error) {
                    console.error("Error searching for book:", error);
                }
            }
        });
    </script>
    <script>
      document.getElementById("searchForm").addEventListener("submit", function(event) {
          event.preventDefault();
          
          let searchQuery = document.getElementById("searchInput").value.trim();
          
          if (searchQuery) {
              fetch(`/check-category?search=${searchQuery}`)
                  .then(response => response.json())
                  .then(data => {
                      if (data.isCategory) {
                          window.location.href = `/genres/${data.categoryId}`; // Redirects to the correct route
                      } else {
                          window.location.href = `/?search=${encodeURIComponent(searchQuery)}`;
                      }
                  })
                  .catch(error => console.error("Error:", error));
          }
      });
      </script>
</body>

</html>